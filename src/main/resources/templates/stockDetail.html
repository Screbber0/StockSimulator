<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="'Stock Detail: ' + ${stock.companyName}">Stock Detail</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .stock-info-container {
            margin-bottom: 20px;
        }
        .stock-info-container h1 {
            margin: 0 0 10px 0;
        }
        .price-info {
            font-size: 1.2em;
        }
        .tradingview-container {
            margin-top: 30px;
        }
    </style>
</head>
<body>

<div class="stock-info-container">
    <h1 th:text="${stock.companyName}">Company Name</h1>
    <p> <strong>Ticker:</strong> <span th:text="${stock.ticker}">SBER</span></p>
    <p class="price-info">
        <strong>Current Price:</strong>
        <span th:text="${stock.currentPrice}">0</span> RUB
        &nbsp;
        <span th:if="${stock.change != null}">
            (<span th:text="${stock.change}">0</span>)
        </span>
        &nbsp;
        <span th:if="${stock.changePercent != null}">
            <span th:text="${stock.changePercent}"></span>%
        </span>
    </p>
    <p><strong>Day High:</strong> <span th:text="${stock.dayHigh}">0</span></p>
    <p><strong>Day Low:</strong> <span th:text="${stock.dayLow}">0</span></p>
    <p><strong>Volume:</strong> <span th:text="${stock.volume}">0</span></p>
</div>

<!-- Контейнер для TradingView виджета -->
<div class="tradingview-container" id="tv_chart_container" style="height:600px; width:800px;"></div>

<!-- Подключаем скрипт TradingView -->
<script src="https://s3.tradingview.com/tv.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    // Подставляем тикер из DTO, например "SBER".
    // TradingView для Московской биржи требует "MOEX:SBER".
    let ticker = /*[[${stock.ticker}]]*/ 'AAPL';

    new TradingView.widget({
        "container_id": "tv_chart_container",
        "width": 800,
        "height": 600,
        "symbol": "MOEX:" + ticker,
        "interval": "D",
        "timezone": "Etc/UTC",
        "theme": "light",
        "style": "1",
        "locale": "ru",
        "toolbar_bg": "#f1f3f6",
        "enable_publishing": false,
        "hide_side_toolbar": false
    });
    /*]]>*/
</script>

</body>
</html>
